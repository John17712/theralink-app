<!DOCTYPE html>
<html lang="{{ lang|default('en') }}">
<head>
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='img/logo.png') }}">

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Theralink â€¢ Sign Up</title>
  <style>
    /* ---------- Base ---------- */
html, body {
  height: 100%;
  margin: 0;
  font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  background: linear-gradient(135deg, #0f2b23, #112831);
  color: #fff;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 16px;
}

/* ---------- Card ---------- */
.card {
  background: rgba(20, 40, 35, 0.95);
  border: 1px solid rgba(0,255,159,0.15);
  border-radius: 16px;
  box-shadow: 0 0 30px rgba(0, 255, 140, 0.1);
  padding: 32px;
  width: 100%;
  max-width: 420px;
  display: flex;
  flex-direction: column;
  gap: 20px;
}

/* ---------- Titles ---------- */
.title {
  margin: 0;
  text-align: center;
  font-size: 1.6rem;
  font-weight: 800;
  color: #00ff9f;
}
.subtitle {
  margin: -6px 0 0 0;
  text-align: center;
  font-weight: 600;
  color: #bfead8;
  opacity: .9;
}

/* ---------- Flash Messages ---------- */
.flash {
  padding: 10px 12px;
  border-radius: 10px;
  font-weight: 600;
}
.flash.success {
  background: rgba(0,255,159,0.12);
  color: #d6ffe7;
  border: 1px solid rgba(0,255,159,0.25);
}
.flash.error {
  background: rgba(255,77,77,0.12);
  color: #ffd6d6;
  border: 1px solid rgba(255,77,77,0.35);
}
.flash.info {
  background: rgba(255,255,255,0.08);
  color: #e7f7f1;
  border: 1px solid rgba(255,255,255,0.12);
}

/* ---------- Form ---------- */
form {
  display: flex;
  flex-direction: column;
  gap: 18px;
}
.form-group {
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.form-group + .form-group {
  margin-top: 6px;
}
label {
  font-weight: 600;
  font-size: 0.9rem;
  color: #bfead8;
}
input {
  padding: 12px;
  border-radius: 10px;
  border: 1px solid rgba(0,255,159,0.15);
  background: #0f2b23;
  color: #fff;
  outline: none;
}
input::placeholder {
  color: #bfead8;
  opacity: 0.8;
}
input:focus {
  border-color: #00ff9f;
}

/* ---------- Hints ---------- */
.hint {
  margin-top: -6px;
  font-size: 0.85rem;
  color: #bfead8;
  opacity: .9;
}

/* ---------- Button ---------- */
.btn {
  width: 100%;
  background: #00ff9f;
  color: #0f2b23;
  font-weight: 800;
  border: none;
  border-radius: 10px;
  padding: 12px;
  cursor: pointer;
  margin-top: 6px;
  transition: background 0.2s ease;
}
.btn:hover {
  background: #00d88c;
}

/* ---------- Links ---------- */
.muted {
  text-align: center;
  font-size: 0.9rem;
  color: #bfead8;
}
.link {
  color: #00ff9f;
  font-weight: 600;
  text-decoration: none;
}
.link:hover {
  text-decoration: underline;
}

/* ---------- Responsive ---------- */
@media (max-width: 480px) {
  .card {
    padding: 24px;
    border-radius: 12px;
  }
  .title {
    font-size: 1.4rem;
  }
  .subtitle {
    font-size: 1rem;
  }
  input, .btn {
    font-size: 1rem;
    padding: 10px;
  }
}

  </style>
</head>
<body>
<div class="card">
  <h1 class="title">Theralink</h1>
  <p class="subtitle" data-i18n="signup_title">Sign Up</p>

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="flash {{ category }}">{{ message }}</div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  <form method="POST" action="{{ url_for('signup') }}" id="signupForm" novalidate>
    <div class="form-group">
      <label for="email" data-i18n="signup_email">Email</label>
      <input type="email" id="email" name="email" required
             data-i18n-placeholder="signup_email_placeholder"
             placeholder="Enter your email" />
    </div>

    <div class="form-group">
      <label for="password" data-i18n="signup_password">Password</label>
      <input
        type="password"
        id="password"
        name="password"
        required
        minlength="6"
        pattern="^(?=.*[^A-Za-z0-9]).{6,}$"
        title="At least 6 characters and 1 special character"
        data-i18n-placeholder="signup_password_placeholder"
        placeholder="Enter your password"
      />
      <div class="hint" data-i18n="signup_password_hint">
        Must be at least 6 characters and include at least one special character.
      </div>
    </div>

    <div class="form-group">
      <label for="confirmPassword" data-i18n="signup_confirm_password">Confirm Password</label>
      <input
        type="password"
        id="confirmPassword"
        required
        minlength="6"
        data-i18n-placeholder="signup_confirm_password_placeholder"
        placeholder="Confirm your password"
      />
    </div>

    <button class="btn" type="submit" data-i18n="signup_button">Create account</button>
  </form>

  <div class="muted">
    <span data-i18n="have_account">Already have an account?</span>
    &nbsp;<a class="link" href="{{ url_for('login') }}" data-i18n="login_prompt">Login</a>
  </div>
</div>


  <script>
    // Language auto-sync (no selector here)
    async function loadTranslations(lang) {
      try {
        const res = await fetch(`/static/lang/${lang}.json`);
        if (!res.ok) return;
        const dict = await res.json();
        document.querySelectorAll("[data-i18n]").forEach(el => {
          const key = el.getAttribute("data-i18n");
          if (dict[key]) el.textContent = dict[key];
        });
        document.querySelectorAll("[data-i18n-placeholder]").forEach(el => {
          const key = el.getAttribute("data-i18n-placeholder");
          if (dict[key]) el.setAttribute("placeholder", dict[key]);
        });
        document.body.setAttribute("dir", lang === "ar" ? "rtl" : "ltr");
      } catch(e) { console.error(e); }
    }
    (function initLanguage(){
      const saved = localStorage.getItem("selectedLanguage") || "{{ lang|default('en') }}";
      loadTranslations(saved);
    })();

    // Client-side confirm check + simple password rule hint
    document.getElementById("signupForm").addEventListener("submit", (e) => {
      const pw = document.getElementById("password").value.trim();
      const cpw = document.getElementById("confirmPassword").value.trim();
      const policy = /^(?=.*[^A-Za-z0-9]).{6,}$/;

      if (!policy.test(pw)) {
        e.preventDefault();
        alert("Password must be at least 6 characters and include at least one special character.");
        return;
      }
      if (pw !== cpw) {
        e.preventDefault();
        alert("Passwords do not match.");
      }
    });
  </script>

  <script src="{{ url_for('static', filename='js/i18n.js') }}"></script>

</body>
</html>

